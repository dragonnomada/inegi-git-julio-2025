# MÓDULO 6 – SERVICIOS DE HOSTING Y AUTENTICACIÓN

> CONFIGURACIÓN DE CUENTAS Y CREDENCIALES PARA SERVICIOS DE HOSTING Y REPOSITORIOS REMOTOS 

## 1. Repositorios remotos

> ¿Qué es un repositorio remoto?

Un **repositorio remoto** es una copia del proyecto alojada en otro equipo o servidor. Permite que múltiples desarrolladores trabajen sobre el mismo código desde distintos lugares.

Ejemplos comunes:
- Servidores internos (`git@<servidor>:/<repos>/<proyecto>.git`)
- Repositorio alojado en una carpeta compartida vía SSH, HTTP o incluso protocolo `file://`.

> ¿Dónde se alojan los repositorios internos?

- En un **servidor bare Git**, inicializado con:

```bash
git init --bare /<ruta>/<repositorio>.git
```

- En una máquina de desarrollo con SSH (por ejemplo, tu computadora actuando como servidor temporal).

## 2. Métodos de autenticación

### SSH (Recomendado para entorno cerrado)

* Seguro, sin necesidad de contraseñas repetidas.
* Requiere generar y registrar una llave pública (`id_rsa.pub`) en el servidor.

> Configuración típica:

1.	Generar una clave SSH (si no tienes una):

```bash
ssh-keygen -t rsa -b 4096 -C "<correo>"
```

2.	Copiar la clave pública al servidor:

```bash
ssh-copy-id <usuario>@<servidor>
```
  
  - Opcionalmente: `ssh-copy-id -p <puerto> <usuario>@<servidor>`
  - Para revisar en el servidor: `cat ~/.ssh/authorized_keys` o `awk '{print $1, substr($2,1,8) "...", $3}' ~/.ssh/authorized_keys`

3.	Clonar o agregar el remoto:

```bash
git clone ssh://<usuario>@<servidor>:/<ruta>/<repositorio>.git
```

Alternativamente:

```bash
git remote add origin ssh://<usuario>@<servidor>:<puerto>/<ruta>/<repositorio>.git
```

**Nota:** Si el puerto es `22` se puede omitir

### HTTP o HTTPS (menos seguro o más difíciles de configurar)

* Puede usarse con `htpasswd` o mecanismos básicos de autenticación.
* Menos seguro si no se usa sobre *HTTPS*.
* Requiere ingreso de `usuario/contraseña` (o `tokens` en algunos casos).

## 3. Configuración de credenciales

Ver y definir el usuario de Git (global o por repositorio):

```bash
git config --global user.name "<usuario>"
git config --global user.email "<correo>"
```

**Nota:** Puedes omitir --global para hacerlo solo en el repositorio actual.

Almacenar credenciales (opcional):

* Para conexiones HTTP con `usuario/contraseña`, puedes guardar credenciales temporalmente:

```bash
# temporal en memoria
git config --global credential.helper cache
```

* O guardarlas en disco (⚠️ menos seguro):

```bash
git config --global credential.helper store
```

## 4. Verificación del repositorio remoto

```bash
git remote -v
```

Muestra la URL de conexión al repositorio remoto.

## 5. Comandos principales

Comando | Descripción
--- | ---
`git remote add origin <url>` | Agrega una URL remota al repositorio actual
`git remote -v` | Verifica URLs remotas configuradas
`ssh-keygen` / `ssh-copy-id` | Generar y copiar llaves para autenticación SSH
`git config credential.helper` | Configura almacenamiento de credenciales
`git init --bare` | Crea un repositorio para servir como remoto
`git clone ssh://...` | Clona desde un servidor interno vía SSH

## 6. Flujos de trabajo

### Inicializar un repositorio remoto

Inicializar un repositorio local

```bash
git init
```

Agregar el repositorio remoto al repositorio local:

```bash
git remote add origin ssh://<usuario>@<servidor>:<puerto>/<ruta>/<repositorio>.git
```

**IMPORTANTE**: Este método solo es efectivo si el repositorio está vacío y sin ramas, es decir, se acaba de crear.

Establecer la rama principal del repositorio remoto:

```bash
git push --set-upstream origin main
```

Alternativamente: `git push -u origin main`

**Nota:** Si el repositorio ya está inicializado, usa la clonación

### Clonar un repositorio remoto

Clonar el repositorio remoto en una carpeta con un nombre local diferente:

```bash
git clone ssh://<usuario>@<servidor>:<puerto>/<ruta>/<repositorio>.git <carpeta>
```

### Trabajar con el repositorio

> Después de hacer un *commit*:

Observar cambios confirmados, pero no enviados al repositorio remoto (falta el `git push`)

```bash
git status
```

```bash
On branch main
Your branch is ahead of 'origin/main' by 1 commit.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
```

Enviar los cambios al repositorio remoto:

```bash
git push
```

> Antes de preparar un *commit*:

Recibir los cambios remotos, sin aplicarlos:

```bash
git fetch
```

```git
remote: Enumerating objects: 5, done.
remote: Counting objects: 100% (5/5), done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (3/3), 353 bytes | 176.00 KiB/s, done.
From ssh://<servidor>:<puerto>/<ruta>/<repositorio>
   <hash1>..<hash2>  main       -> origin/main
```

Analizar los cambios pendientes (falta `git pull`)

```bash
git status
```

```bash
On branch main
Your branch is behind 'origin/main' by 1 commit, and can be fast-forwarded.
  (use "git pull" to update your local branch)

nothing to commit, working tree clean
```

> Después de lanzar nuestro *commit* y si no causó conflictos

Aplicar los cambios pendiente:

```bash
git pull
```

**IMPORTANTE:** En el flujo de trabajo, antes de preparar un *commit* podríamos obtener los cambios para ver que no hayan conflictos previos a nuestra confirmación, para prevenir resolver los conflictos manualmente. A veces, será inevitable, por lo que no debemos hacer `pull` hasta que hayamos hecho nuestro *commit*, para no perder cambios sensibles.