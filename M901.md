# MÓDULO 9. FUSIONES DE TRES VÍAS

> IMPORTANCIA Y CONFIGURACIÓN DE FUSIONES DE TRES VÍAS

## 1. Fusión de tres vías

> ¿Qué es una fusión de tres vías?

Una **fusión de tres vías** (three-way merge) ocurre cuando Git necesita combinar **dos ramas que tienen un ancestro común**, pero **ambas han tenido cambios desde ese punto**.

Git utiliza tres versiones del archivo:

```text
  A
 / \
B   C
 \ /
  D
```

- `A`: el **ancestro común** (base de fusión)
- `B`: la **rama actual (HEAD)**
- `C`: la **rama que se va a fusionar**
- `D`: el resultado de la fusión

## 2. Importancia

> ¿Por qué es importante hacer la fusión de tres vías?

Porque evita sobrescribir cambios cuando varias personas trabajan en paralelo. Git compara lo que cambió en ambas ramas desde su base común, y **fusiona solo las diferencias**, o marca los **conflictos** si no puede hacerlo automáticamente.

> ¿Cuándo ocurre?

- Cuando haces `git merge <rama>` y ambas ramas han cambiado desde el punto en que se separaron.
- También durante un `git pull` si hay cambios en `origin` y en tu local.

## 3. Ejemplo práctico

Supongamos que estamos en una etapa de desarrollo y los programadores separan sus ramas de desarrollos del ancestro común que será la rama `dev`:

```text
   |     |     |     |
   |     |     |     |
   |     |     |     |
   |     |     |     |
   |     |     |     |
dev/1 dev/2 dev/3 dev/main
--------------------------  
           dev              <--- abc123
````

Entonces, cada rama del desarrollador evoluciona en paralelo de forma independiente partiendo de la misma base.

Cuando llega el final de la etapa (los desarrolladores ya tienen el código funcional de esta primera etapa), entonces se necesitará hacer una fusión en tres vías a hacia la rama de comparación que los sigue (`dev/main`), es decir, cada desarrollador formará tres vías respecto a la vía paralela de fusión:

```text
   --------
   dev/main      <--- def456
      |          [merge]
     / \
    /   \
   /     \
   |     |
   |     |
   |     |
   |     |
   |     |
dev/1 dev/main
-------------- 
      dev        <--- abc123
````

Así para cada desarrollador que fusionará sus cambios con la rama `dev/main`. Al final, se tendrá una única rama `dev/main` con todos los cambios integrados de los desarrolladores.

```text
          --------
          dev/main             <--- cba789
             |
             /\
            /  \
           /    \
          /      \
         /        \
        /          \
       /            \
       |            |
       |         --------
       |         dev/main      <--- def456
       |            |          [merge]
       |           / \
       |          /   \
       |         /     \
       |         |     |
       |         |     |
       |         |     |
       |         |     |
       |         |     |
    dev/2     dev/1 dev/main
    ------------------------ 
            dev                <--- abc123
````

Por lo tanto, las fusiones de tres vías localmente se ven como fusiones entre una rama ancestro (`dev`), dos ramas que se desean fusionar (`dev/x` y `dev/main`) y la rama fusionada resultante (`dev/main`).

Al final de las fusiones, quedará la rama `dev/main` que habrá resuelto todos los conflictos entre los cambios de cada desarrollador al final de su etapa.

Esta rama resultante será propuesta como la rama base `dev` en la siguiente etapa:

```text
   |     |     |     |
   |     |     |     |
   |     |     |     |
   |     |     |     |
   |     |     |     |
dev/1 dev/2 dev/3 dev/main
--------------------------  
           dev              <--- fde987
--------------------------
        dev/main            <--- fde987
        --------
           |
          / \               [último merge con el dev/3]
````

Así, podemos completar una etapa de desarrollo y prepararnos para la siguiente.
